---
title: "Problemas Resueltos TD"
author: "Claudia Trias de Tena"
format:
 typst:
    fig-format: png
 html: default
editor: visual
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Problema 1

Aplica los criterios de decisión bajo incertidumbre e indica cual es la alternativa
óptima basándote en la siguiente tabla y teniendo en cuenta todos los posibles
criterios de decisión. Considera el problema para ambas situaciones: costes y
beneficios.

NOTA: Usar las funciones individuales de incertidumbre por separado.

```{r, echo = FALSE}
library(knitr)
tabla <- data.frame(e1 = c(7, 4,-2),
                    e2 = c(0,3,1),
                    e3 = c(5,8,4))
rownames(tabla) <- c("d1", "d2", "d3")

knitr::kable(tabla)

```

**Solución**

Cargamos las funciones con las que vamos a trabajar:

```{r}
source("C:/Users/usuario/OneDrive/Desktop/5º CARRERA/TD/TDecisionCodigo/teoriadecision_funciones_incertidumbre.R")
```

Creamos la tabla en el formato que necesitan dichas funciones:

```{r}

tb = crea.tablaX(c(7,4,-2,
                  0,3,1,
                  5,8,4),
                  numalternativas = 3,
                  numestados = 3)

```

Consideramos ambos casos y resolvemos el problema:

```{r}

# Caso favorable (Beneficios)

c1 = criterio.Wald(tb, favorable = TRUE)
c2 = criterio.Optimista(tb, favorable = TRUE)
c3 = criterio.Hurwicz(tb, alfa =0.4, favorable = TRUE)
c4 = criterio.Savage(tb, favorable = TRUE)
c5 = criterio.Laplace(tb, favorable = TRUE)
c6 = criterio.PuntoIdeal(tb, favorable = TRUE)

resumen_alt_op = data.frame(Criterio = c("Wald", "Optimista", "Hurwicz", "Savage", "Laplace", "Punto Ideal"),
                            Alternativa_Optima = c(c1$AlternativaOptima, c2$AlternativaOptima, c3$AlternativaOptima, c4$AlternativaOptima, c5$AlternativaOptima, c6$AlternativaOptima))

knitr::kable(resumen_alt_op, caption = "Resumen Alternativas Óptimas - Caso Favorable")

```

Luego, concluimos que la **alternativa óptima** es d3.

Veamos el gráfico del Criterio de Hurwicz para los distintos valores de alpha:

```{r, fig.height = 3}

dibuja.criterio.Hurwicz(tb, favorable = TRUE)

```

Observamos que la alternativa óptima para todo los posibles valores de alpha en el intervalo [0,1] es d3. Luego no existe ningún punto de corte entre las rectas asociadas a las distintas alternativas.


```{r}

# Caso desfavorable (Costes)

c1d = criterio.Wald(tb, favorable = FALSE)
c2d = criterio.Optimista(tb, favorable = FALSE)
c3d = criterio.Hurwicz(tb, alfa =0.4, FALSE)
c4d = criterio.Savage(tb, favorable = FALSE)
c5d = criterio.Laplace(tb, favorable = FALSE)
c6d = criterio.PuntoIdeal(tb, favorable = FALSE)

resumen_alt_op = data.frame(Criterio = c("Wald", "Optimista", "Hurwicz", "Savage", "Laplace", "Punto Ideal"),
                            Alternativa_Optima = c(c1d$AlternativaOptima, c2d$AlternativaOptima, c3d$AlternativaOptima, c4d$AlternativaOptima, c5d$AlternativaOptima, c6d$AlternativaOptima))

knitr::kable(resumen_alt_op, caption = "Resumen Alternativas Óptimas - Caso Desfavorable")

```

Luego se concluye que la **alternativa óptima** es d2, salvo bajo el criterio optimista que es d1.


Veamos los gráficos del Criterio de Hurwicz para los distintos valores de alpha:

```{r}
dibuja.criterio.Hurwicz(tb, favorable = FALSE)

```

Observamos que para un valor de alpha en el intervalo (0.6, 0.8), la alternativa óptima pasa de ser la 2 a la 1. Veamos con el siguiente gráfico en que punto ocurre esto.

```{r}

dibuja.criterio.Hurwicz_Intervalos(tb, favorable = FALSE)

```
El punto en el que la alternativa óptima pasa de ser la segunda a la primera es 0.667.

\newpage

# Problema 2

Paula y Claudia quieren hacer algo de deporte el fin de semana. Deciden que el día
que mejor les viene es el domingo, pero no se ponen de acuerdo en el deporte que hacer.
A ver si usted puede ayudarles. Tienen las siguientes opciones:

- Hacer escalada en un rocódromo. El equipo de escalada ya lo tienen
pero han de pagar por la hora de uso de las instalaciones 20 euros por persona. Planean
estar dos horas y la vuelta la harán andando si no llueve y en uber si, por el contrario,
llueve. El precio del uber será 15 euros entre las dos.

- Salir a correr por el parque de al lado de su casa. Si decidiesen esto, deberían
comprarse unos zapatos adecuados para ello, que les costarían 45 euros a cada una. La vuelta
la harían andando, lloviese o no, pues no se van a alejar mucho de su casa.

- Montar en bici. Para ello, tendrían que alquilarlas en una tienda cerca de su casa.
El precio de alquiler es de 15 euros por hora y por persona. La vuelta la harían en bici
si no llueve y en uber si llueve. Teniendo en cuenta que el uber ha de ser especial pues
tiene que tener sitio para dos bicicletas, el precio es de 40 euros entre las dos.


¿Qué les recomienda usted que hagan, si su objetivo es minimizar los costes?

**Solución**

Creamos la tabla en el formato que necesitan las funciones:

```{r}

tb2 = crea.tablaX(c(80, 95, 90, 90, 60, 100), numalternativas = 3, numestados = 2,
                  nb_alternativas = c("Escalada","Correr", "Bici"),
                  nb_estados = c("No llueve", "Llueve"))

```

Se trata de un problema de costes, luego la situación es desfavorable. Resolvamos el problema según todos los criterios que conocemos:

```{r}
library(tinytable)
tt(criterio.Todos(tb2, 0.3, favorable = FALSE), rownames = TRUE)

```

Luego la **alternativa óptima** es montar en bici, salvo bajo el criterio de Wald (Criterio pesimista) que es correr.

Añadimos los gráficos del Criterio de Hurwicz

```{r}
dibuja.criterio.Hurwicz(tb2, favorable = FALSE)
```

Observamos que para un valor de alpha en el intervalo (0.2, 0.4), la alternativa óptima pasa de ser la 2 a la 3. Veamos con el siguiente gráfico en que punto ocurre esto.

```{r}
dibuja.criterio.Hurwicz_Intervalos(tb2,favorable = FALSE)

```

El punto en el que la alternativa óptima pasa de ser la segunda a la tercera es 0.25.